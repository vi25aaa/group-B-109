library(ggplot2)
library(dplyr)

fuel_corr <- fuel %>%
  transmute(
    Production = `U.S..Crude.Oil.Stocks..Thousand.Barrels.`,
    Inventory  = `U.S..Gasoline.Stocks..Thousand.Barrels.`
  )

fuel_corr <- na.omit(fuel_corr)

summary(fuel_corr)
ggplot(fuel_corr, aes(x = Production, y = Inventory)) +
  geom_point(alpha = 0.6) +
  geom_smooth(method = "lm", se = TRUE) +
  labs(
    title = "Relationship Between U.S. Crude Oil and Gasoline Stocks",
    x = "U.S. Crude Oil Stocks (Thousand Barrels)",
    y = "U.S. Gasoline Stocks (Thousand Barrels)"
  ) +
  theme_minimal()
ggplot(fuel_corr, aes(x = Production)) +
  geom_histogram(bins = 30) +
  labs(
    title = "Distribution of U.S. Crude Oil Stocks",
    x = "U.S. Crude Oil Stocks (Thousand Barrels)",
    y = "Frequency"
  ) +
  theme_minimal()
ggplot(fuel_corr, aes(x = Inventory)) +
  geom_histogram(bins = 30) +
  labs(
    title = "Distribution of U.S. Gasoline Stocks",
    x = "U.S. Gasoline Stocks (Thousand Barrels)",
    y = "Frequency"
  ) +
  theme_minimal()
cor_test_result <- cor.test(
  fuel_corr$Production,
  fuel_corr$Inventory,
  method = "pearson"
)

cor_test_result

